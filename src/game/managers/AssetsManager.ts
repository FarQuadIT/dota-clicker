/**
 * –ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –∏–≥—Ä—ã Dota Clicker
 * 
 * –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã:
 * 1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –∏–≥—Ä–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã (—Ç–µ–∫—Å—Ç—É—Ä—ã, –∑–≤—É–∫–∏, —Å–ø—Ä–∞–π—Ç—à–∏—Ç—ã)
 * 2. –ö—ç—à–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
 * 3. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –∑–∞–≥—Ä—É–∑–∫–∏
 * 4. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç PixiJS Assets API –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
 * 
 * –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: 
 * - PixiJS Assets: https://pixijs.download/release/docs/assets.Assets.html
 * - –í all_pixijs_content.txt —Ä–∞–∑–¥–µ–ª "Assets"
 */

import { Assets, Texture } from 'pixi.js';

// ==================================================================================
// –¢–ò–ü–´ –î–ê–ù–ù–´–• –î–õ–Ø –ú–ï–ù–ï–î–ñ–ï–†–ê –†–ï–°–£–†–°–û–í
// ==================================================================================

/**
 * –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
 * –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
 */
interface GameAssets {
  // –¢–µ–∫—Å—Ç—É—Ä—ã –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
      /**
     * –ò–Ω–¥–µ–∫—Å–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è —Ö—Ä–∞–Ω–∏—Ç—å –≥–µ—Ä–æ–µ–≤ —Å –ª—é–±—ã–º –∏–º–µ–Ω–µ–º
     * 
     * –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
     * 
     * // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –≥–µ—Ä–æ—è –≤ –∏–≥—Ä—É
     * this.assets.heroes["axe"] = { 
     *   idle: axeIdleTexture, 
     *   run: axeRunTexture, 
     *   attack: axeAttackTexture 
     * };
     * 
     * // –î–æ—Å—Ç—É–ø –∫ —Ç–µ–∫—Å—Ç—É—Ä–∞–º –≥–µ—Ä–æ—è –ø–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–º—É –∫–ª—é—á—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)
     * const heroTexture = this.assets.heroes[heroConfig.name].idle;
     */
  heroes: {
    [heroName: string]: HeroAssets;
  };
  
  // –¢–µ–∫—Å—Ç—É—Ä—ã –≤—Ä–∞–≥–æ–≤
  creeps: {
    [creepName: string]: CreepAssets;
  };
  
  // –§–æ–Ω–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  backgrounds: {
    [bgName: string]: Texture;
    forest: Texture;
  };
  
  // UI —ç–ª–µ–º–µ–Ω—Ç—ã
  ui: {
    [uiName: string]: Texture;
    gold: Texture;
    health: Texture;
    mana: Texture;
  };
}

/**
 * –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–µ–∫—Å—Ç—É—Ä –¥–ª—è –≥–µ—Ä–æ–µ–≤
 * –°–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–±–æ—Ä –∞–Ω–∏–º–∞—Ü–∏–π —Å –∏—Ö —Ç–µ–∫—Å—Ç—É—Ä–∞–º–∏
 * –ò–Ω–¥–µ–∫—Å–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ [animation: string] –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –ø–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–º—É –∫–ª—é—á—É
 */
interface HeroAssets {
  [animation: string]: Texture;
  idle: Texture;      // –ê–Ω–∏–º–∞—Ü–∏—è –æ–∂–∏–¥–∞–Ω–∏—è
  run: Texture;       // –ê–Ω–∏–º–∞—Ü–∏—è –±–µ–≥–∞
  attack: Texture;    // –ê–Ω–∏–º–∞—Ü–∏—è –∞—Ç–∞–∫–∏
}

/**
 * –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–µ–∫—Å—Ç—É—Ä –¥–ª—è –≤—Ä–∞–≥–æ–≤ (–∫—Ä–∏–ø–æ–≤)
 * –°–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–±–æ—Ä –∞–Ω–∏–º–∞—Ü–∏–π —Å –∏—Ö —Ç–µ–∫—Å—Ç—É—Ä–∞–º–∏
 * –ò–Ω–¥–µ–∫—Å–Ω–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –ø–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–º—É –∫–ª—é—á—É
 */
interface CreepAssets {
  [animation: string]: Texture;
  idle: Texture;      // –ê–Ω–∏–º–∞—Ü–∏—è –æ–∂–∏–¥–∞–Ω–∏—è
  attack: Texture;    // –ê–Ω–∏–º–∞—Ü–∏—è –∞—Ç–∞–∫–∏
  death: Texture;     // –ê–Ω–∏–º–∞—Ü–∏—è —Å–º–µ—Ä—Ç–∏
}

/**
 * –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏
 */
interface LoadingProgress {
  loaded: number;      // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
  total: number;       // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Å—É—Ä—Å–æ–≤
  percentage: number;  // –ü—Ä–æ—Ü–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ (0-100)
  currentAsset: string; // –¢–µ–∫—É—â–∏–π –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–π —Ä–µ—Å—É—Ä—Å
}

/**
 * –ö–ª–∞—Å—Å-—Å–∏–Ω–≥–ª—Ç–æ–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–≤—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
 * 
 * –ü–∞—Ç—Ç–µ—Ä–Ω Singleton –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –º–µ–Ω–µ–¥–∂–µ—Ä–∞
 * –ø–æ –≤—Å–µ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é, —á—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –∏
 * —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é
 */
class AssetsManager {
  // –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞
  private static instance: AssetsManager;
  
  // –û–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
  // Partial<GameAssets> –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–µ –≤—Å–µ –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —Å—Ä–∞–∑—É
  private assets: Partial<GameAssets> = {};
  
  // –û–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
  private loadingProgress: LoadingProgress = {
    loaded: 0,
    total: 0,
    percentage: 0,
    currentAsset: ''
  };
  
  // –ú–∞—Å—Å–∏–≤ —Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –∑–∞–≥—Ä—É–∑–∫–∏
  // –ü–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º UI –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
  private progressCallbacks: ((progress: LoadingProgress) => void)[] = [];
  
  // –§–ª–∞–≥, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
  private isLoaded = false;

  /**
   * –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (Singleton)
   * –ï—Å–ª–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–Ω –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω
   * –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ–Ω–µ–¥–∂–µ—Ä—É –∏–∑ –ª—é–±–æ–π —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   */
  public static getInstance(): AssetsManager {
    if (!AssetsManager.instance) {
      AssetsManager.instance = new AssetsManager();
    }
    return AssetsManager.instance;
  }

  /**
   * –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Singleton
   * –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–ª–∞—Å—Å –º–æ–∂–Ω–æ –∏–Ω—Å—Ç–∞–Ω—Ü–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ getInstance()
   */
  private constructor() {
    console.log('üé® –°–æ–∑–¥–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —Ä–µ—Å—É—Ä—Å–æ–≤');
  }

  /**
   * –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –∏–≥—Ä–æ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
   * 
   * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç PixiJS Assets API –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
   * –û—Ä–≥–∞–Ω–∏–∑—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ä–µ—Å—É—Ä—Å–æ–≤
   * –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
   */
  public async loadGameAssets(): Promise<void> {
    try {
      console.log('üì¶ –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏–≥—Ä–æ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤...');
      
      // –°–æ–∑–¥–∞–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç - —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –æ–ø–∏—Å—ã–≤–∞—é—â—É—é –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
      const assetManifest = this.createAssetManifest();
      
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏
      // –°—á–∏—Ç–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
      this.loadingProgress.total = this.countTotalAssets(assetManifest);
      this.loadingProgress.loaded = 0;
      this.loadingProgress.percentage = 0;
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–µ—Ä–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ (0%)
      this.notifyProgress();

      // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª—è –ª—É—á—à–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º await –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Å–µ—Ç—å
      await this.loadHeroAssets(assetManifest.heroes);
      await this.loadCreepAssets(assetManifest.creeps);
      await this.loadBackgroundAssets(assetManifest.backgrounds);
      await this.loadUIAssets(assetManifest.ui);

      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
      this.isLoaded = true;
      console.log('‚úÖ –í—Å–µ —Ä–µ—Å—É—Ä—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ');
      
    } catch (error) {
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏
      console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤:', error);
      throw error; // –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –¥–∞–ª—å—à–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—ã—à–µ
    }
  }

  /**
   * –°–æ–∑–¥–∞–Ω–∏–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –≤—Å–µ—Ö –∏–≥—Ä–æ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
   * 
   * –ú–∞–Ω–∏—Ñ–µ—Å—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ –≥–¥–µ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è
   * –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—É—Ç–µ–π –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –ø–∞–ø–∫–µ public/media/
   * 
   * @returns –û–±—ä–µ–∫—Ç, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π –≤—Å–µ –ø—É—Ç–∏ –∫ —Ä–µ—Å—É—Ä—Å–∞–º
   */
  private createAssetManifest() {
    return {
      // –†–µ—Å—É—Ä—Å—ã –≥–µ—Ä–æ–µ–≤ - –ø—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π
      heroes: {
        juggernaut: {
          idle: '/media/game/assets/heroes/juggernaut_idle.png',
          run: '/media/game/assets/heroes/juggernaut_run.png', 
          attack: '/media/game/assets/heroes/juggernaut_attack.png'
        }
      },
      
      // –†–µ—Å—É—Ä—Å—ã –≤—Ä–∞–≥–æ–≤ (–∫—Ä–∏–ø–æ–≤) - –ø—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π
      creeps: {
        direCreep: {
          idle: '/media/game/assets/creeps/dire_creep_idle.png',
          attack: '/media/game/assets/creeps/dire_creep_attack.png',
          death: '/media/game/assets/creeps/dire_creep_death.png'
        },
        wolf: {
          idle: '/media/game/assets/creeps/wolf_idle.png',
          attack: '/media/game/assets/creeps/wolf_attack.png', 
          death: '/media/game/assets/creeps/wolf_death.png'
        }
      },
      
      // –§–æ–Ω–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∏–≥—Ä–æ–≤—ã—Ö –ª–æ–∫–∞—Ü–∏–π
      backgrounds: {
        forest: '/media/game/images/forest_background.png'
      },
      
      // –≠–ª–µ–º–µ–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
      ui: {
        gold: '/media/shop/images/gold.png',
        health: '/media/shop/main/health.png',
        mana: '/media/shop/main/mana.png'
      }
    };
  }

  /**
   * –ü–æ–¥—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
   * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
   * 
   * @param manifest - –ú–∞–Ω–∏—Ñ–µ—Å—Ç —Ä–µ—Å—É—Ä—Å–æ–≤
   * @returns –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
   */
  private countTotalAssets(manifest: any): number {
    let count = 0;
    
    // –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ–±—ä–µ–∫—Ç–µ
    // –ö–∞–∂–¥–æ–µ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
    const countInObject = (obj: any) => {
      Object.values(obj).forEach(value => {
        if (typeof value === 'string') {
          count++; // –≠—Ç–æ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
        } else if (typeof value === 'object') {
          countInObject(value); // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å—á–∏—Ç–∞–µ–º –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã
        }
      });
    };
    
    countInObject(manifest);
    return count;
  }

  /**
   * –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –≥–µ—Ä–æ–µ–≤
   * 
   * @param heroManifest - –û–±—ä–µ–∫—Ç —Å –ø—É—Ç—è–º–∏ –∫ —Ä–µ—Å—É—Ä—Å–∞–º –≥–µ—Ä–æ–µ–≤
   */
  private async loadHeroAssets(heroManifest: any): Promise<void> {
    console.log('ü¶∏ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã –≥–µ—Ä–æ–µ–≤...');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –≥–µ—Ä–æ–µ–≤
    this.assets.heroes = {};
    
    // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ—Ö –≥–µ—Ä–æ–µ–≤ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
    for (const [heroName, heroPaths] of Object.entries(heroManifest)) {
      this.loadingProgress.currentAsset = `–ì–µ—Ä–æ–π: ${heroName}`;
      this.notifyProgress();
      
      // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç—É—Ä –∞–Ω–∏–º–∞—Ü–∏–π –≥–µ—Ä–æ—è
      const heroAssets: HeroAssets = {} as HeroAssets;
      
      // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞–∂–¥—É—é –∞–Ω–∏–º–∞—Ü–∏—é –≥–µ—Ä–æ—è
      for (const [animName, path] of Object.entries(heroPaths as any)) {
        try {
          // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –∑–∞–≥—Ä—É–∂–∞–µ–º–æ–º —Ä–µ—Å—É—Ä—Å–µ
          this.loadingProgress.currentAsset = `${heroName} - ${animName}`;
          this.notifyProgress();
          
          // –ò—Å–ø–æ–ª—å–∑—É–µ–º Assets.load() –∏–∑ PixiJS –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–∫—Å—Ç—É—Ä—ã
          // –≠—Ç–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º await
          const texture = await Assets.load(path as string);
          heroAssets[animName] = texture;
          
          // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
          this.incrementProgress();
          
          console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è ${animName} –¥–ª—è –≥–µ—Ä–æ—è ${heroName}`);
          
        } catch (error) {
          // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–µ–ª—É—é —Ç–µ–∫—Å—Ç—É—Ä—É –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
          console.error(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ${path}:`, error);
          heroAssets[animName] = Texture.WHITE; // Texture.WHITE - –ø—É—Å—Ç–∞—è –±–µ–ª–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞ –∏–∑ PixiJS
          this.incrementProgress();
        }
      }
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—É—Ä—ã –≥–µ—Ä–æ—è –≤ –æ–±—â–∏–π –æ–±—ä–µ–∫—Ç —Ä–µ—Å—É—Ä—Å–æ–≤
      this.assets.heroes![heroName] = heroAssets;
    }
  }

  /**
   * –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤—Ä–∞–≥–æ–≤ (–∫—Ä–∏–ø–æ–≤)
   * –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω loadHeroAssets
   * 
   * @param creepManifest - –û–±—ä–µ–∫—Ç —Å –ø—É—Ç—è–º–∏ –∫ —Ä–µ—Å—É—Ä—Å–∞–º –≤—Ä–∞–≥–æ–≤
   */
  private async loadCreepAssets(creepManifest: any): Promise<void> {
    console.log('üëπ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã –≤—Ä–∞–≥–æ–≤...');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –≤—Ä–∞–≥–æ–≤
    this.assets.creeps = {};
    
    // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
    for (const [creepName, creepPaths] of Object.entries(creepManifest)) {
      this.loadingProgress.currentAsset = `–í—Ä–∞–≥: ${creepName}`;
      this.notifyProgress();
      
      // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—Å—Ç—É—Ä –∞–Ω–∏–º–∞—Ü–∏–π –≤—Ä–∞–≥–∞
      const creepAssets: CreepAssets = {} as CreepAssets;
      
      // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞–∂–¥—É—é –∞–Ω–∏–º–∞—Ü–∏—é –≤—Ä–∞–≥–∞
      for (const [animName, path] of Object.entries(creepPaths as any)) {
        try {
          this.loadingProgress.currentAsset = `${creepName} - ${animName}`;
          this.notifyProgress();
          
          // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—Å—Ç—É—Ä—É –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ—ë
          const texture = await Assets.load(path as string);
          creepAssets[animName] = texture;
          
          this.incrementProgress();
          
          console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏—è ${animName} –¥–ª—è –≤—Ä–∞–≥–∞ ${creepName}`);
          
        } catch (error) {
          console.error(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ${path}:`, error);
          creepAssets[animName] = Texture.WHITE;
          this.incrementProgress();
        }
      }
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—É—Ä—ã –≤—Ä–∞–≥–∞ –≤ –æ–±—â–∏–π –æ–±—ä–µ–∫—Ç —Ä–µ—Å—É—Ä—Å–æ–≤
      this.assets.creeps![creepName] = creepAssets;
    }
  }

  /**
   * –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ–Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   * 
   * @param bgManifest - –û–±—ä–µ–∫—Ç —Å –ø—É—Ç—è–º–∏ –∫ —Ñ–æ–Ω–æ–≤—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º
   */
  private async loadBackgroundAssets(bgManifest: any): Promise<void> {
    console.log('üå≤ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ–Ω–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ–Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    this.assets.backgrounds = {} as GameAssets['backgrounds'];
    
    // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ñ–æ–Ω—ã –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
    for (const [bgName, path] of Object.entries(bgManifest)) {
      try {
        this.loadingProgress.currentAsset = `–§–æ–Ω: ${bgName}`;
        this.notifyProgress();
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—Å—Ç—É—Ä—É —Ñ–æ–Ω–∞
        const texture = await Assets.load(path as string);
        this.assets.backgrounds[bgName] = texture;
        
        this.incrementProgress();
        
        console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω —Ñ–æ–Ω ${bgName}`);
        
      } catch (error) {
        // –ü—Ä–∏ –æ—à–∏–±–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–µ–ª—É—é —Ç–µ–∫—Å—Ç—É—Ä—É –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
        console.error(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ–Ω–∞ ${path}:`, error);
        this.assets.backgrounds[bgName] = Texture.WHITE;
        this.incrementProgress();
      }
    }
  }

  /**
   * –ó–∞–≥—Ä—É–∑–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
   * 
   * @param uiManifest - –û–±—ä–µ–∫—Ç —Å –ø—É—Ç—è–º–∏ –∫ UI —ç–ª–µ–º–µ–Ω—Ç–∞–º
   */
  private async loadUIAssets(uiManifest: any): Promise<void> {
    console.log('üéÆ –ó–∞–≥—Ä—É–∂–∞–µ–º UI —ç–ª–µ–º–µ–Ω—Ç—ã...');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    this.assets.ui = {} as GameAssets['ui'];
    
    // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ UI —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
    for (const [uiName, path] of Object.entries(uiManifest)) {
      try {
        this.loadingProgress.currentAsset = `UI: ${uiName}`;
        this.notifyProgress();
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—Å—Ç—É—Ä—É UI —ç–ª–µ–º–µ–Ω—Ç–∞
        const texture = await Assets.load(path as string);
        this.assets.ui[uiName] = texture;
        
        this.incrementProgress();
        
        console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω UI —ç–ª–µ–º–µ–Ω—Ç ${uiName}`);
        
      } catch (error) {
        console.error(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ UI ${path}:`, error);
        this.assets.ui[uiName] = Texture.WHITE;
        this.incrementProgress();
      }
    }
  }

  /**
   * –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
   * –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞
   */
  private incrementProgress(): void {
    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
    this.loadingProgress.loaded++;
    
    // –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–∫—Ä—É–≥–ª—è–µ–º –¥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞
    this.loadingProgress.percentage = Math.round(
      (this.loadingProgress.loaded / this.loadingProgress.total) * 100
    );
    
    // –£–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –æ –Ω–æ–≤–æ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
    this.notifyProgress();
  }

  /**
   * –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –∑–∞–≥—Ä—É–∑–∫–∏
   * –í—ã–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–ª–±—ç–∫–∏ —Å —Ç–µ–∫—É—â–∏–º –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
   */
  private notifyProgress(): void {
    // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–±—ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–ø–∏—é –æ–±—ä–µ–∫—Ç–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    this.progressCallbacks.forEach(callback => {
      callback({ ...this.loadingProgress }); // –ü–µ—Ä–µ–¥–∞–µ–º –∫–æ–ø–∏—é –æ–±—ä–µ–∫—Ç–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –º—É—Ç–∞—Ü–∏–π
    });
  }

  // =============================================================================
  // –ü–£–ë–õ–ò–ß–ù–´–ï –ú–ï–¢–û–î–´ –î–õ–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –†–ï–°–£–†–°–û–í
  // =============================================================================

  /**
   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç—É—Ä—ã –≥–µ—Ä–æ—è
   * 
   * @param heroName - –∏–º—è –≥–µ—Ä–æ—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'juggernaut')
   * @param animation - —Ç–∏–ø –∞–Ω–∏–º–∞—Ü–∏–∏ ('idle', 'run', 'attack')
   * @returns Texture –∏–ª–∏ fallback –≤ —Å–ª—É—á–∞–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ç–µ–∫—Å—Ç—É—Ä—ã
   */
  public getHeroTexture(heroName: string, animation: string): Texture {
    // –ü–æ–ª—É—á–∞–µ–º –æ–±—ä–µ–∫—Ç —Å —Ç–µ–∫—Å—Ç—É—Ä–∞–º–∏ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≥–µ—Ä–æ—è
    const heroAssets = this.assets.heroes?.[heroName];
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –≥–µ—Ä–æ–π –∏ —Ç—Ä–µ–±—É–µ–º–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
    if (heroAssets && heroAssets[animation]) {
      return heroAssets[animation];
    }
    
    // –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç—É—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –≤—ã–≤–æ–¥–∏–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –±–µ–ª—É—é —Ç–µ–∫—Å—Ç—É—Ä—É
    console.warn(`‚ö†Ô∏è –¢–µ–∫—Å—Ç—É—Ä–∞ –≥–µ—Ä–æ—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: ${heroName}.${animation}`);
    return Texture.WHITE; // Fallback - –±–µ–ª–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞
  }

  /**
   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç—É—Ä—ã –≤—Ä–∞–≥–∞
   * 
   * @param creepName - –∏–º—è –≤—Ä–∞–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'direCreep')
   * @param animation - —Ç–∏–ø –∞–Ω–∏–º–∞—Ü–∏–∏ ('idle', 'attack', 'death')
   * @returns Texture –∏–ª–∏ fallback –≤ —Å–ª—É—á–∞–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ç–µ–∫—Å—Ç—É—Ä—ã
   */
  public getCreepTexture(creepName: string, animation: string): Texture {
    const creepAssets = this.assets.creeps?.[creepName];
    if (creepAssets && creepAssets[animation]) {
      return creepAssets[animation];
    }
    
    console.warn(`‚ö†Ô∏è –¢–µ–∫—Å—Ç—É—Ä–∞ –≤—Ä–∞–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: ${creepName}.${animation}`);
    return Texture.WHITE;
  }

  /**
   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–æ–Ω–æ–≤–æ–π —Ç–µ–∫—Å—Ç—É—Ä—ã
   * 
   * @param bgName - –∏–º—è —Ñ–æ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'forest')
   * @returns Texture –∏–ª–∏ fallback –≤ —Å–ª—É—á–∞–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ç–µ–∫—Å—Ç—É—Ä—ã
   */
  public getBackgroundTexture(bgName: string): Texture {
    const bgTexture = this.assets.backgrounds?.[bgName];
    if (bgTexture) {
      return bgTexture;
    }
    
    console.warn(`‚ö†Ô∏è –§–æ–Ω–æ–≤–∞—è —Ç–µ–∫—Å—Ç—É—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: ${bgName}`);
    return Texture.WHITE;
  }

  /**
   * –ü–æ–ª—É—á–µ–Ω–∏–µ UI —Ç–µ–∫—Å—Ç—É—Ä—ã
   * 
   * @param uiName - –∏–º—è UI —ç–ª–µ–º–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'gold')
   * @returns Texture –∏–ª–∏ fallback –≤ —Å–ª—É—á–∞–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ç–µ–∫—Å—Ç—É—Ä—ã
   */
  public getUITexture(uiName: string): Texture {
    const uiTexture = this.assets.ui?.[uiName];
    if (uiTexture) {
      return uiTexture;
    }
    
    console.warn(`‚ö†Ô∏è UI —Ç–µ–∫—Å—Ç—É—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: ${uiName}`);
    return Texture.WHITE;
  }

  /**
   * –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
   * –ü–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º UI –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
   * 
   * @param callback - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
   */
  public onProgress(callback: (progress: LoadingProgress) => void): void {
    // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–ª–±—ç–∫ –≤ –º–∞—Å—Å–∏–≤ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
    this.progressCallbacks.push(callback);
    
    // –°—Ä–∞–∑—É –≤—ã–∑—ã–≤–∞–µ–º –∫–æ–ª–±—ç–∫ —Å —Ç–µ–∫—É—â–∏–º –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º, —á—Ç–æ–±—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å UI
    callback({ ...this.loadingProgress });
  }

  /**
   * –û—Ç–ø–∏—Å–∫–∞ –æ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
   * –í–∞–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
   * 
   * @param callback - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
   */
  public offProgress(callback: (progress: LoadingProgress) => void): void {
    // –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å –∫–æ–ª–±—ç–∫–∞ –≤ –º–∞—Å—Å–∏–≤–µ
    const index = this.progressCallbacks.indexOf(callback);
    
    // –ï—Å–ª–∏ –∫–æ–ª–±—ç–∫ –Ω–∞–π–¥–µ–Ω, —É–¥–∞–ª—è–µ–º –µ–≥–æ
    if (index > -1) {
      this.progressCallbacks.splice(index, 1);
    }
  }

  /**
   * –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
   * 
   * @returns true –µ—Å–ª–∏ –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∏–Ω–∞—á–µ false
   */
  public getIsLoaded(): boolean {
    return this.isLoaded;
  }

  /**
   * –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
   * 
   * @returns –æ–±—ä–µ–∫—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –∑–∞–≥—Ä—É–∑–∫–∏
   */
  public getProgress(): LoadingProgress {
    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–ø–∏—é –æ–±—ä–µ–∫—Ç–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –º—É—Ç–∞—Ü–∏–π
    return { ...this.loadingProgress };
  }
}

// –°–æ–∑–¥–∞–µ–º –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
// –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
export const assetsManager = AssetsManager.getInstance();

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–∏–ø –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö
export type { LoadingProgress };